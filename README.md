# KYC é è¨€æ©Ÿç³»çµ±

> ä½¿ç”¨ ROFL (Runtime Off-chain Logic) æ¶æ§‹å¯¦ç¾å®‰å…¨ã€éš±ç§ä¿è­·çš„éˆä¸Šèº«ä»½é©—è­‰ç³»çµ±

[![License: MIT](https://img.shields.io/badge(https://opensource.org/licenses/MIThttps://img.shields.io/badge(https://docs.oasis.io/dapp/sapphire/ ç›®éŒ„

- [å°ˆæ¡ˆç°¡ä»‹](#å°ˆæ¡ˆç°¡ä»‹)
- [ç³»çµ±æ¶æ§‹](#ç³»çµ±æ¶æ§‹)
- [æŠ€è¡“æ£§](#æŠ€è¡“æ£§)
- [å®Œæ•´æµç¨‹](#å®Œæ•´æµç¨‹)
- [ç³»çµ±å„ªå‹¢](#ç³»çµ±å„ªå‹¢)
- [å¿«é€Ÿé–‹å§‹](#å¿«é€Ÿé–‹å§‹)
- [éƒ¨ç½²æŒ‡å—](#éƒ¨ç½²æŒ‡å—)
- [ä½¿ç”¨ç¯„ä¾‹](#ä½¿ç”¨ç¯„ä¾‹)
- [æ‡‰ç”¨å ´æ™¯](#æ‡‰ç”¨å ´æ™¯)
- [æŠ€è¡“åŸç†](#æŠ€è¡“åŸç†)
- [å¸¸è¦‹å•é¡Œ](#å¸¸è¦‹å•é¡Œ)
- [License](#license)

***

## å°ˆæ¡ˆç°¡ä»‹

æœ¬å°ˆæ¡ˆå¯¦ä½œäº†ä¸€å¥—**ä¸éœ€ä¿¡ä»»çš„ KYCï¼ˆKnow Your Customerï¼‰é è¨€æ©Ÿç³»çµ±**ï¼Œçµåˆå€å¡Šéˆæ™ºèƒ½åˆç´„èˆ‡éˆä¸‹ ROFL æœå‹™ï¼Œåœ¨ä¿è­·ç”¨æˆ¶éš±ç§çš„åŒæ™‚ï¼Œå°‡èº«ä»½é©—è­‰çµæœå®‰å…¨åœ°è¨˜éŒ„åˆ°å€å¡Šéˆä¸Šã€‚

### æ ¸å¿ƒå•é¡Œ

å‚³çµ± KYC ç³»çµ±é¢è‡¨çš„æŒ‘æˆ°ï¼š
- âŒ ä¸­å¿ƒåŒ–ä¿¡ä»»å•é¡Œ
- âŒ éš±ç§è³‡æ–™å¤–æ´©é¢¨éšª
- âŒ éˆä¸Šé‹ç®—æˆæœ¬é«˜æ˜‚
- âŒ å¤šå¹³å°é‡è¤‡é©—è­‰

### è§£æ±ºæ–¹æ¡ˆ

æœ¬ç³»çµ±é€é ROFL æ¶æ§‹ï¼š
- âœ… éˆä¸‹è™•ç†æ•æ„Ÿè³‡æ–™ï¼Œä¿è­·éš±ç§
- âœ… TEE ç’°å¢ƒä¿è­‰åŸ·è¡Œå®‰å…¨
- âœ… éˆä¸Šå„²å­˜é©—è­‰çµæœï¼Œä¸å¯ç¯¡æ”¹
- âœ… å¯†ç¢¼å­¸è­‰æ˜ç¢ºä¿è³‡æ–™çœŸå¯¦æ€§

***

## ç³»çµ±æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ä½¿ç”¨è€…     â”‚
â”‚  (éŒ¢åŒ…åœ°å€)  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ POST /verify
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     [translate:ROFL] æœå‹™ (Go)   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  å¯ä¿¡åŸ·è¡Œç’°å¢ƒ (TEE)         â”‚  â”‚
â”‚  â”‚  - æ¥æ”¶ KYC è«‹æ±‚           â”‚  â”‚
â”‚  â”‚  - å‘¼å« KYC API            â”‚  â”‚
â”‚  â”‚  - ç”¢ç”ŸåŠ å¯†è­‰æ˜            â”‚  â”‚
â”‚  â”‚  - ç°½ç½²ä¸¦æäº¤äº¤æ˜“          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚ å‘¼å« KYC API
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  KYC API Mock    â”‚      â”‚  æ™ºèƒ½åˆç´„ (Solidity)  â”‚
â”‚  (Vercel)        â”‚      â”‚  (Oasis Sapphire)    â”‚
â”‚  - èº«ä»½é©—è­‰      â”‚      â”‚  - å„²å­˜ KYC ç‹€æ…‹     â”‚
â”‚  - é¢¨éšªè©•ä¼°      â”‚â†â”€â”€â”€â”€â”€â”‚  - æ¬Šé™æ§åˆ¶          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ é©—è­‰ â”‚  - å…¬é–‹æŸ¥è©¢æ¥å£      â”‚
                    çµæœ  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†‘
                           â”‚ updateKYCStatus()
                    [translate:ROFL] ç°½ç½²äº¤æ˜“æäº¤
```

### ç›®éŒ„çµæ§‹

```
test2_é è¨€æ©Ÿç·šä¸‹KYC/
â”œâ”€â”€ kyc-api-mock/              # æ¨¡æ“¬ KYC API (Vercel éƒ¨ç½²)
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ verify.js          # KYC é©—è­‰é‚è¼¯
â”‚   â”œâ”€â”€ vercel.json            # Vercel éƒ¨ç½²é…ç½®
â”‚   â””â”€â”€ README.md
â”‚
â”œâ”€â”€ kyc-oracle-rofl/           # [translate:ROFL] éˆä¸‹æœå‹™ (Go)
â”‚   â”œâ”€â”€ main.go                # ä¸»ç¨‹å¼
â”‚   â”œâ”€â”€ go.mod                 # Go ä¾è³´ç®¡ç†
â”‚   â”œâ”€â”€ go.sum
â”‚   â”œâ”€â”€ .env.example           # ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹
â”‚   â”œâ”€â”€ Dockerfile             # Docker å®¹å™¨åŒ–
â”‚   â”œâ”€â”€ compose.yaml           # Docker Compose é…ç½®
â”‚   â””â”€â”€ README.md
â”‚
â”œâ”€â”€ kyc-smart-contracts/       # æ™ºèƒ½åˆç´„ (Solidity)
â”‚   â””â”€â”€ KYCOracle.sol          # KYC é è¨€æ©Ÿåˆç´„
â”‚
â””â”€â”€ README.md                  # æœ¬æ–‡ä»¶
```

***

## æŠ€è¡“æ£§

### æ™ºèƒ½åˆç´„
- **èªè¨€**: Solidity ^0.8.20
- **å€å¡Šéˆ**: Oasis Sapphire (EVM å…¼å®¹)
- **åŠŸèƒ½**: å„²å­˜ KYC ç‹€æ…‹ã€æ¬Šé™æ§åˆ¶ã€å…¬é–‹æŸ¥è©¢

### ROFL æœå‹™
- **èªè¨€**: Go 1.21+
- **æ¡†æ¶**: æ¨™æº– HTTP æœå‹™
- **åŠŸèƒ½**: API ä¸­ä»‹ã€è­‰æ˜ç”Ÿæˆã€äº¤æ˜“ç°½ç½²

### KYC API
- **å¹³å°**: Vercel Serverless
- **èªè¨€**: Node.js
- **åŠŸèƒ½**: æ¨¡æ“¬èº«ä»½é©—è­‰èˆ‡é¢¨éšªè©•ä¼°

***

## å®Œæ•´æµç¨‹

### 0. æ¨¡æ“¬selfé©—è­‰çµæœ
```bash
curl -X POST http://localhost:3001/api/mock-verify \
  -H "Content-Type: application/json" \
  -d '{
    "user_address": "0x37d8f4aC0b11D13Ab148bB9FF053F9C3379CfF2E",
    "nationality": "TWN",
    "age": 30
  }'
```

### 1. ç”¨æˆ¶ç™¼èµ· KYC è«‹æ±‚

```bash
curl -X POST http://localhost:8080/verify \
  -H "Content-Type: application/json" \
  -d '{
    "user_address": "0x37d8f4aC0b11D13Ab148bB9FF053F9C3379CfF2E",
    "document_id": "A123456789",
    "document_type": "passport"
  }'
```

### 2. ROFL æœå‹™è™•ç†æµç¨‹

```
æ¥æ”¶è«‹æ±‚
  â†“
å‘¼å« KYC API
  â†“
ç²å–é©—è­‰çµæœ (verified: true/false, risk_score: 0-100)
  â†“
ç”¢ç”Ÿè­‰æ˜é›œæ¹Š = SHA256(user_address + verified + risk_score + timestamp)
  â†“
ç°½ç½²äº¤æ˜“ (ä½¿ç”¨ ROFL ç§é‘°)
  â†“
æäº¤åˆ°æ™ºèƒ½åˆç´„ updateKYCStatus()
  â†“
è¿”å›æˆåŠŸè¨Šæ¯
```

### 3. æ™ºèƒ½åˆç´„å„²å­˜ç‹€æ…‹

```solidity
struct KYCStatus {
    bool verified;        // æ˜¯å¦é€šéé©—è­‰
    uint8 riskLevel;      // é¢¨éšªç­‰ç´š 0-100
    uint256 timestamp;    // é©—è­‰æ™‚é–“æˆ³
    bytes32 proofHash;    // è­‰æ˜é›œæ¹Š
}
```

### 4. æŸ¥è©¢ KYC ç‹€æ…‹

```solidity
bool isVerified = kycOracle.isKYCVerified(userAddress);

(bool verified, uint8 riskLevel, uint256 timestamp, bytes32 proofHash) 
  = kycOracle.getKYCStatus(userAddress);
```

***

## ç³»çµ±å„ªå‹¢

### ğŸ”’ éš±ç§ä¿è­·
- éˆä¸‹ ROFL çš„ TEE ç’°å¢ƒè™•ç†æ•æ„Ÿè³‡æ–™
- KYC API ä¿è­·ç«¯é»ä¸å…¬é–‹
- éˆä¸Šåªå„²å­˜é©—è­‰çµæœï¼Œä¸å„²å­˜èº«ä»½åŸå§‹è³‡æ–™

### â›“ï¸ ä¸éœ€ä¿¡ä»»
- ç¡¬é«”éš”é›¢çš„å¯ä¿¡åŸ·è¡Œç’°å¢ƒ (TEE)
- å¯†ç¢¼å­¸è­‰æ˜ç¢ºä¿è³‡æ–™çœŸå¯¦æ€§
- æ™ºèƒ½åˆç´„æ§åˆ¶æ¬Šé™é˜²æ­¢æœªæˆæ¬Šæ›´æ–°
- å€å¡Šéˆä¿éšœè³‡æ–™ä¸å¯ç¯¡æ”¹

### ğŸ’° æˆæœ¬å„ªåŒ–
- è¤‡é›œé‹ç®—åœ¨éˆä¸‹åŸ·è¡Œï¼Œç¯€çœ Gas è²»ç”¨
- éˆä¸Šåªå„²å­˜çµæœèˆ‡è­‰æ˜é›œæ¹Š

### ğŸŒ äº’æ“ä½œæ€§
- EVM å…¼å®¹æ™ºèƒ½åˆç´„
- æ¨™æº–åŒ–æŸ¥è©¢è«‹æ±‚æ¥å£
- æ˜“æ–¼è·¨éˆå’Œè·¨å¹³å°é›†æˆ

***

## å¿«é€Ÿé–‹å§‹

### å®‰è£ä¾è³´ã€éƒ¨ç½²èˆ‡å•Ÿå‹•

ï½œæ¨¡æ“¬ KYC APIï½œéƒ¨ç½²ï½œ

```bash
cd kyc-api-mock
npm install -g vercel
vercel login
vercel --prod
```

ï½œä½ˆç½²æ™ºèƒ½åˆç´„ï½œ

- ä½¿ç”¨ Remix ç·¨è­¯ã€éƒ¨ç½² `KYCOracle.sol`ï¼Œä½¿ç”¨ Solidity 0.8.20+
- é€£æ¥åˆ° Sapphire Testnetï¼Œéƒ¨ç½²ä¸¦è¨˜éŒ„åˆç´„åœ°å€

ï½œé…ç½® ROFL æœå‹™ï½œ

ç·¨è¼¯ `.env`ï¼Œå¡«å¯«ï¼š

```
SAPPHIRE_RPC_URL=https://testnet.sapphire.oasis.io
CONTRACT_ADDRESS=0xä½ çš„åˆç´„åœ°å€
ROFL_PRIVATE_KEY=ä½ çš„ç§é‘°ï¼ˆå»æ‰ 0xï¼‰
KYC_API_KEY=ä½ çš„ API é‡‘é‘°
KYC_API_URL=https://ä½ çš„ vercel-api-url/verify
PORT=8080
```

å•Ÿå‹•ï¼š

```bash
cd kyc-oracle-rofl
go mod tidy
go run main.go
```

***

## ä½¿ç”¨ç¯„ä¾‹

### ç™¼é€ KYC è«‹æ±‚

```js
await fetch('http://localhost:8080/verify', {
  method: 'POST',
  headers: {'Content-Type': 'application/json'},
  body: JSON.stringify({
    user_address: userWalletAddress,
    document_id: 'A123456789',
    document_type: 'passport'
  })
});
```

### æŸ¥è©¢éˆä¸Šç‹€æ…‹

```js
const isVerified = await kycOracle.isKYCVerified(userWalletAddress);
const [verified, riskLevel] = await kycOracle.getKYCStatus(userWalletAddress);
console.log('ç‹€æ…‹:', verified, 'é¢¨éšªåˆ†æ•¸:', riskLevel);
```

***

## æ‡‰ç”¨å ´æ™¯

- DeFi å¹³å°èº«ä»½é©—è­‰
- NFT å¸‚å ´çœŸå¯¦äº¤æ˜“ä¿éšœ
- æ´»å‹• NFT å¯¦ååˆ¶é©—è­‰
- é‡‘èæœå‹™é›†åœ˜è·¨å¹³å°èº«ä»½äº’èª

***

## License

MIT License Â© 2025

è©³è¦‹ [LICENSE](LICENSE)
